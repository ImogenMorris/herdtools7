<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>NativeBackend (herdtools7.Asllib.Native.NativeBackend)</title><link rel="stylesheet" href="../../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">herdtools7</a> &#x00BB; <a href="../../index.html">Asllib</a> &#x00BB; <a href="../index.html">Native</a> &#x00BB; NativeBackend</nav><header class="odoc-preamble"><h1>Module <code><span>Native.NativeBackend</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-value"><a href="#type-value" class="anchor"></a><code><span><span class="keyword">type</span> value</span><span> = <a href="../index.html#type-native_value">native_value</a></span></code></div><div class="spec-doc"><p>The runtime values that the interpreter should use.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_value"><a href="#val-debug_value" class="anchor"></a><code><span><span class="keyword">val</span> debug_value : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>A printer for value, should only be used for debugging.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_undetermined"><a href="#val-is_undetermined" class="anchor"></a><code><span><span class="keyword">val</span> is_undetermined : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_undetermined v</code> returns true when <code>c</code> is a non-constant value</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-v_of_literal"><a href="#val-v_of_literal" class="anchor"></a><code><span><span class="keyword">val</span> v_of_literal : <span><a href="../../AST/index.html#type-literal">AST.literal</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p><code>v_of_parsed_v</code> constructs a value from a parsed value. Note that the prefered method to create records or any complex values is <code>create_vector</code>, and should be used for constructing complex values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-v_unknown_of_type"><a href="#val-v_unknown_of_type" class="anchor"></a><code><span><span class="keyword">val</span> v_unknown_of_type : <span><a href="../../AST/index.html#type-ty">AST.ty</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p><code>v_unknown_of_type t</code> constructs a value from a type.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-v_of_int"><a href="#val-v_of_int" class="anchor"></a><code><span><span class="keyword">val</span> v_of_int : <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-value">value</a></span></code></div><div class="spec-doc"><p><code>v_of_int</code> is used to convert raw integers arising from the interpretation, and not parsed values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-v_to_int"><a href="#val-v_to_int" class="anchor"></a><code><span><span class="keyword">val</span> v_to_int : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span>int option</span></span></code></div><div class="spec-doc"><p><code>v_to_int v</code> returns, if possible, an integer corresponding to the value. Should be called only on values of type integer.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-m"><a href="#type-m" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a m</span></span><span> = <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Main monad type to chain operations done by the interpreter.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-return"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Monadic constructor.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-warnT"><a href="#val-warnT" class="anchor"></a><code><span><span class="keyword">val</span> warnT : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Add warning message</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bind_data"><a href="#val-bind_data" class="anchor"></a><code><span><span class="keyword">val</span> bind_data : <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Monadic bind operation, used when data from the first operation is needed to compute the second operation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bind_seq"><a href="#val-bind_seq" class="anchor"></a><code><span><span class="keyword">val</span> bind_seq : <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Monadic bind operation, but that only passes internal interpreter data. This should not create any data-dependency.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bind_ctrl"><a href="#val-bind_ctrl" class="anchor"></a><code><span><span class="keyword">val</span> bind_ctrl : <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Monadic bind operation, but that creates a control dependency between the first argument and the result of the second one.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-prod_par"><a href="#val-prod_par" class="anchor"></a><code><span><span class="keyword">val</span> prod_par : <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Monadic product operation, two monads are combined &quot;in parallel&quot;.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-appl_data"><a href="#val-appl_data" class="anchor"></a><code><span><span class="keyword">val</span> appl_data : <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Applicative map.</p><p>Creates a data dependency between the output events and the input events of the argument in the resulting monad.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-choice"><a href="#val-choice" class="anchor"></a><code><span><span class="keyword">val</span> choice : <span><span><a href="#type-value">value</a> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>choice is a boolean if operator.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-delay"><a href="#val-delay" class="anchor"></a><code><span><span class="keyword">val</span> delay : <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>delay operator spits monad into result <code>'a</code> and hidden structure. This permits deciding on the monad value, while using hidden structure later</p></div></div><p>Special operations with vectors</p><div class="odoc-spec"><div class="spec value anchored" id="val-create_vector"><a href="#val-create_vector" class="anchor"></a><code><span><span class="keyword">val</span> create_vector : <span><span><a href="#type-value">value</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Creates a vector with this values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_record"><a href="#val-create_record" class="anchor"></a><code><span><span class="keyword">val</span> create_record : <span><span><span>(<a href="../../AST/index.html#type-identifier">AST.identifier</a> * <a href="#type-value">value</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Creates a record, with the indicated names.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-create_exception"><a href="#val-create_exception" class="anchor"></a><code><span><span class="keyword">val</span> create_exception : <span><span><span>(<a href="../../AST/index.html#type-identifier">AST.identifier</a> * <a href="#type-value">value</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Creates an exception, with the indicated names.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_index"><a href="#val-get_index" class="anchor"></a><code><span><span class="keyword">val</span> get_index : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>get_i i vec</code> returns value at index <code>i</code> inside <code>vec</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_index"><a href="#val-set_index" class="anchor"></a><code><span><span class="keyword">val</span> set_index : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>set_i i v vec</code> returns <code>vec</code> with index <code>i</code> replaced by <code>v</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_field"><a href="#val-get_field" class="anchor"></a><code><span><span class="keyword">val</span> get_field : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>get_field &quot;foo&quot; v</code> is the value mapped by &quot;foo&quot; in the record <code>v</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_field"><a href="#val-set_field" class="anchor"></a><code><span><span class="keyword">val</span> set_field : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>set_field &quot;foo&quot; v record</code> is <code>record</code> with &quot;foo&quot; mapping to <code>v</code>.</p></div></div><p>Other operations</p><div class="odoc-spec"><div class="spec value anchored" id="val-binop"><a href="#val-binop" class="anchor"></a><code><span><span class="keyword">val</span> binop : <span><a href="../../AST/index.html#type-binop">AST.binop</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Evaluates the binary operation on those two values.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unop"><a href="#val-unop" class="anchor"></a><code><span><span class="keyword">val</span> unop : <span><a href="../../AST/index.html#type-unop">AST.unop</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Evaluate this unary operation on this value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ternary"><a href="#val-ternary" class="anchor"></a><code><span><span class="keyword">val</span> ternary : <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>ternary v w1 w2</code> is w1 if v is true and w2 if v is false</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-on_read_identifier"><a href="#val-on_read_identifier" class="anchor"></a><code><span><span class="keyword">val</span> on_read_identifier : <span><a href="../../AST/index.html#type-identifier">AST.identifier</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../AST/index.html#type-scope">AST.scope</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>on_read_identifier</code> is called when a value is read from the local environment.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-on_write_identifier"><a href="#val-on_write_identifier" class="anchor"></a><code><span><span class="keyword">val</span> on_write_identifier : <span><a href="../../AST/index.html#type-identifier">AST.identifier</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../AST/index.html#type-scope">AST.scope</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>on_write_identifier</code> is called when a value is read from the local environment.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_from_bitvector"><a href="#val-read_from_bitvector" class="anchor"></a><code><span><span class="keyword">val</span> read_from_bitvector : <span><span><span>(<a href="#type-value">value</a> * <a href="#type-value">value</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Read a slice (represented by a list of positions) from a bitvector.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_to_bitvector"><a href="#val-write_to_bitvector" class="anchor"></a><code><span><span class="keyword">val</span> write_to_bitvector : <span><span><span>(<a href="#type-value">value</a> * <a href="#type-value">value</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>write_to_bitvector positions w v</code> writes the bits of <code>w</code> into <code>v</code> at the specified positions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-concat_bitvectors"><a href="#val-concat_bitvectors" class="anchor"></a><code><span><span class="keyword">val</span> concat_bitvectors : <span><span><a href="#type-value">value</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>Similar to Bitvector.concat, but monadic style obviously.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-primitive"><a href="#type-primitive" class="anchor"></a><code><span><span class="keyword">type</span> primitive</span><span> = <span><span><span><a href="#type-value">value</a> <a href="#type-m">m</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><a href="#type-value">value</a> <a href="#type-m">m</a></span> list</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p>primitive types that go with this AST.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ast"><a href="#type-ast" class="anchor"></a><code><span><span class="keyword">type</span> ast</span><span> = <span><a href="#type-primitive">primitive</a> <a href="../../AST/index.html#type-t">AST.t</a></span></span></code></div><div class="spec-doc"><p>The considered AST type.</p></div></div></div></body></html>